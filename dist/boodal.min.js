/* Roger Thomas - GitHub - https://github.com/rogerthomas84/boodal */
let boodal={_helpers:function(){return this.genClass=function(){return"boodal-modal"},this.multiRequired=function(){return["title","body","options","ok.callback"]},this.inputRequired=function(){return["title","body","ok.callback"]},this.alertDefaults=function(){return{ok:"OK","ok.callback":function(){},"ok.class":"btn-secondary","modal.backdrop":"static","modal.keyboard":!1,"modal.focus":!0}},this.multiFromMultiDefaults=function(){let l=this.singleFromMultiDefaults();return l.vals=null,delete l.val,l},this.inputDefaults=function(){return this.singleFromMultiDefaults()},this.singleFromMultiDefaults=function(){return{attrs:{},val:null,placeholder:null,ok:"OK","ok.class":"btn-primary",cancel:"Cancel","cancel.callback":function(){},"cancel.class":"btn-light","modal.backdrop":"static","modal.focus":!0,"modal.close":!0}},this.arrayToObjectForMulti=function(l){if(!1===Array.isArray(l))return l;let e={};for(let o=0;o<l.length;o++)e[l[o]]=l[o];return e},this.genId=function(){function l(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return(l()+l()+l()+l()+l()+l()+l()+l()).toLowerCase()},this.isHtml=function(l){let e=(new DOMParser).parseFromString(l,"text/html");return Array.from(e.body.childNodes).some(l=>1===l.nodeType)},this.requireKeys=function(l,e,o){for(let o=0;o<e.length;o++){let a=l[e[o]];if(null==a)throw'boodal: Key of "'+e[o]+'" must be defined and cannot be empty'}for(let e in o)!1!==o.hasOwnProperty(e)&&(void 0!==l[e]&&null!==l[e]||(l[e]=o[e]));return l},this.buildModalOpts=function(l){return{backdrop:l["modal.backdrop"],keyboard:l["modal.keyboard"],focus:l["modal.focus"],show:l["modal.show"]}},this.resetModalEvents=function(l){let e=$("."+l);$("button.close",e).off("click"),e.off("hide.bs.modal"),e.off("hidden.bs.modal"),e.off("show.bs.modal"),e.off("shown.bs.modal")},this.boodalPlace=function(l,e,o,a,t,d,n,s){let c=$("<div />").addClass(l).addClass("modal").attr("tabindex","-1").attr("role","dialog"),i=$("<div />").addClass("modal-dialog").attr("role","document"),r=$("<div />").addClass("modal-content"),u=$("<div />").addClass("modal-header").html($("<h5 />").addClass("modal-title").html(e));!0===s&&u.append($("<button />").addClass("close").attr("type","button").attr("data-dismiss","modal").attr("aria-label","Close").html($("<span />").attr("aria-hidden","true").html("&times;"))),this.isHtml(o)||(o=$("<p />").addClass("boodal-p").html(o)),r.append(u).append($("<div />").addClass("modal-body").html(o));let h=$("<div />").addClass("modal-footer pr-2 pt-2 pb-2 pl-2");if(null!==a){let l=$("<button />").attr("type","button").addClass("btn boodal-ok").addClass(d).html(a);h.append(l)}if(null!==t){let l=$("<button />").attr("type","button").addClass("btn").addClass("boodal-cancel").addClass(n).html(t).attr("data-dismiss","modal");h.prepend(l)}r.append(h),i.append(r),c.append(i),$("body").append(c)},this.genericInput=function(l,e){let o=this;(l=o._helpers().requireKeys(l,o.inputRequired(),o.inputDefaults()))["modal.keyboard"]=!1,l["modal.show"]=!0;let a=o.genClass();o.boodalPlace(a,l.title,l.body,l.ok,l.cancel,l["ok.class"],l["cancel.class"],l["modal.close"]);let t=$("."+a),d=$("<input />").attr("type",e).addClass("form-control").addClass("boodal-input");null!==l.val&&d.val(l.val),null!==l.placeholder&&d.attr("placeholder",l.placeholder),void 0!==l.attrs.class&&d.addClass(l.attrs.class),void 0!==l.attrs.id&&d.attr("id",l.attrs.id),$(".modal-body",t).append(d);let n=$(".modal-body input.boodal-input",t);t.on("shown.bs.modal",function(l){n.focus()}),t.modal(o.buildModalOpts(l)),o.resetModalEvents(a),$("button.close",t).on("click",function(){l["ok.callback"]=function(){},$(".boodal-cancel",t).click()}),t.on("hide.bs.modal",function(e){let o=n.val();void 0===o?o=null:0===o.length&&(o=null),l["ok.callback"](o)}),t.on("hidden.bs.modal",function(){o.resetModalEvents(a),$("."+a).remove()}),$(".boodal-ok",t).on("click",function(l){l.preventDefault(),$("."+a).modal("hide")}),$(".boodal-cancel",t).on("click",function(e){e.preventDefault(),t.off("hide.bs.modal"),t.on("hide.bs.modal",function(){l["cancel.callback"]()}),t.modal("hide")})},this},alert:function(l){let e=this;(l=e._helpers().requireKeys(l,["title","body"],e._helpers().alertDefaults()))["modal.show"]=!0;let o=e._helpers().genClass();e._helpers().boodalPlace(o,l.title,l.body,l.ok,null,l["ok.class"],null,!1);let a=$("."+o);a.modal(e._helpers().buildModalOpts(l)),e._helpers().resetModalEvents(o),a.on("hide.bs.modal",function(){l["ok.callback"]()}),a.on("hidden.bs.modal",function(){e._helpers().resetModalEvents(o),$("."+o).remove()}),$(".boodal-ok",a).on("click",function(l){l.preventDefault(),$("."+o).modal("hide")})},select:function(l){let e=this;(l=e._helpers().requireKeys(l,e._helpers().multiRequired(),e._helpers().singleFromMultiDefaults()))["modal.keyboard"]=!1,l["modal.show"]=!0;let o=e._helpers().genClass();e._helpers().boodalPlace(o,l.title,l.body,l.ok,l.cancel,l["ok.class"],l["cancel.class"],l["modal.close"]);let a=$("."+o),t=$("<select />").addClass("custom-select").addClass("boodal-select");null!==l.placeholder&&t.append($("<option />").prop("disabled",!0).prop("selected",!0).html(l.placeholder)),void 0!==l.attrs.class&&t.addClass(l.attrs.class),void 0!==l.attrs.id&&t.attr("id",l.attrs.id);let d=e._helpers().arrayToObjectForMulti(l.options);for(let e in d){if(!1===d.hasOwnProperty(e))continue;let o=$("<option />").attr("value",e).html(d[e]);l.val===e&&o.prop("selected",!0),t.append(o)}null!==l.val&&$('option[value="'+l.val+'"]',t).prop("selected",!0),$(".modal-body",a).append(t);let n=$(".modal-body select.boodal-select",a);a.on("shown.bs.modal",function(l){n.focus()}),a.modal(e._helpers().buildModalOpts(l)),e._helpers().resetModalEvents(o),$("button.close",a).on("click",function(){l["ok.callback"]=function(){},$(".boodal-cancel",a).click()}),a.on("hide.bs.modal",function(e){let o=$("option:selected",n).attr("value");void 0===o?o=null:0===o.length&&(o=null),l["ok.callback"](o)}),a.on("hidden.bs.modal",function(){e._helpers().resetModalEvents(o),$("."+o).remove()}),$(".boodal-ok",a).on("click",function(l){l.preventDefault(),$("."+o).modal("hide")}),$(".boodal-cancel",a).on("click",function(e){e.preventDefault(),a.off("hide.bs.modal"),a.on("hide.bs.modal",function(){l["cancel.callback"]()}),a.modal("hide")})},checkbox:function(l){let e=this;l=e._helpers().requireKeys(l,e._helpers().multiRequired(),e._helpers().multiFromMultiDefaults()),Array.isArray(l.vals)||(l.vals=[]),l["modal.keyboard"]=!1,l["modal.show"]=!0;let o=e._helpers().genClass();e._helpers().boodalPlace(o,l.title,l.body,l.ok,l.cancel,l["ok.class"],l["cancel.class"],l["modal.close"]);let a=$("."+o),t=e._helpers().arrayToObjectForMulti(l.options);for(let o in t){if(!1===t.hasOwnProperty(o))continue;let d="boodalCheck"+e._helpers().genId(),n=$("<div />").addClass("form-check"),s=$("<input />").addClass("form-check-input").addClass("boodal-check").attr("type","checkbox").attr("value",o).attr("id",d);void 0!==l.attrs.class&&s.addClass(l.attrs.class),-1!==l.vals.indexOf(o)&&s.prop("checked",!0),n.append(s).append($("<label />").addClass("form-check-label").attr("for",d).html(t[o])),$(".modal-body",a).append(n)}a.modal(e._helpers().buildModalOpts(l)),e._helpers().resetModalEvents(o),$("button.close",a).on("click",function(){l["ok.callback"]=function(){},$(".boodal-cancel",a).click()}),a.on("hide.bs.modal",function(e){let o=[],t=$(".boodal-check",$(".modal-body",a));for(let l=0;l<t.length;l++){let e=$(t[l]);e.is(":checked")&&o.push(e.attr("value"))}0===o.length&&(o=null),l["ok.callback"](o)}),a.on("hidden.bs.modal",function(){e._helpers().resetModalEvents(o),$("."+o).remove()}),$(".boodal-ok",a).on("click",function(l){l.preventDefault(),$("."+o).modal("hide")}),$(".boodal-cancel",a).on("click",function(e){e.preventDefault(),a.off("hide.bs.modal"),a.on("hide.bs.modal",function(){l["cancel.callback"]()}),a.modal("hide")})},radio:function(l){let e=this;(l=e._helpers().requireKeys(l,e._helpers().multiRequired(),e._helpers().singleFromMultiDefaults()))["modal.keyboard"]=!1,l["modal.show"]=!0;let o=e._helpers().genClass();e._helpers().boodalPlace(o,l.title,l.body,l.ok,l.cancel,l["ok.class"],l["cancel.class"],l["modal.close"]);let a=$("."+o),t="boodalRadio"+e._helpers().genId(),d=e._helpers().arrayToObjectForMulti(l.options);for(let o in d){if(!1===d.hasOwnProperty(o))continue;let n="boodalCheck"+e._helpers().genId(),s=$("<div />").addClass("form-check"),c=$("<input />").addClass("form-check-input").addClass("boodal-radio").attr("type","radio").attr("value",o).attr("id",n).attr("name",t);void 0!==l.attrs.class&&c.addClass(l.attrs.class),l.val!==o&&null!==l.val||c.prop("checked",!0),s.append(c).append($("<label />").addClass("form-check-label").attr("for",n).html(d[o])),$(".modal-body",a).append(s)}a.modal(e._helpers().buildModalOpts(l)),e._helpers().resetModalEvents(o),$("button.close",a).on("click",function(){l["ok.callback"]=function(){},$(".boodal-cancel",a).click()}),a.on("hide.bs.modal",function(e){let o=$(".boodal-radio:checked",$(".modal-body",a)).attr("value");void 0===o?o=null:0===o.length&&(o=null),l["ok.callback"](o)}),a.on("hidden.bs.modal",function(){e._helpers().resetModalEvents(o),$("."+o).remove()}),$(".boodal-ok",a).on("click",function(l){l.preventDefault(),$("."+o).modal("hide")}),$(".boodal-cancel",a).on("click",function(e){e.preventDefault(),a.off("hide.bs.modal"),a.on("hide.bs.modal",function(){l["cancel.callback"]()}),a.modal("hide")})},text:function(l){this._helpers().genericInput(l,"text")},email:function(l){this._helpers().genericInput(l,"email")},number:function(l){this._helpers().genericInput(l,"number")}};